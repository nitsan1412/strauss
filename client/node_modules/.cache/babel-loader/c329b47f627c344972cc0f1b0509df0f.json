{"ast":null,"code":"var _jsxFileName = \"D:\\\\programming stuff\\\\strauss\\\\client\\\\src\\\\helpers\\\\AppContext.jsx\";\nimport React, { useState, createContext, useContext } from \"react\";\nimport { useForceUpdate } from \"./ForceUpdate\";\nimport Game from \"../logic/Game\";\nimport CharacterManager from \"../logic/CharacterManager\";\nimport { Rule } from \"../logic/Rule\";\nimport { playSound } from \"./Sounds\";\nimport { useMusic } from \"./MusicContext\";\nconst AppContext = createContext < any > null;\nexport const useGame = () => useContext(AppContext);\nexport function GameProvider({\n  children\n}) {\n  const forceUpdate = useForceUpdate();\n  const [game, setGame] = useState < any > new Game();\n  const [intervalHandler, setIntervalHandler] = useState < any > undefined;\n  const searchParams = new URLSearchParams(window.location.search);\n  const {\n    stopMusic,\n    startMusic\n  } = useMusic();\n\n  const start = () => {\n    const game = getGameFromURL();\n    setGame(game);\n    game.start();\n    if (!localStorage.getItem(\"isGameMuted\") || localStorage.getItem(\"isGameMuted\") === \"false\") startMusic();\n    const interval = setInterval(() => {\n      const numberOfFinished = game.characterManager.charactersDone().length;\n      game.step();\n      forceUpdate();\n\n      if (numberOfFinished < game.characterManager.charactersDone().length) {\n        playSound(\"meow\", game.isGameMuted);\n      }\n\n      if (game.status === \"over\") {\n        clearInterval(interval);\n        playSound(\"newHighScore\", game.isGameMuted);\n      }\n    }, Game.STEP * 1000);\n    setIntervalHandler(interval);\n  };\n\n  const chooseRule = rule => {\n    game.chooseRule(rule);\n    forceUpdate();\n  };\n\n  const declineRule = rule => {\n    game.ruleManager.declineRule(rule);\n    forceUpdate();\n  };\n\n  const changeGameSounds = () => {\n    localStorage.setItem(\"isGameMuted\", String(!game.isGameMuted));\n    if (!game.isGameMuted) stopMusic();else startMusic();\n    game.isGameMuted = !game.isGameMuted;\n  };\n\n  const cancel = () => {\n    clearInterval(intervalHandler);\n    setIntervalHandler(undefined);\n    setGame(undefined);\n    forceUpdate();\n    if (!game.isGameMuted) stopMusic();\n  };\n\n  const cancelMusic = () => {\n    if (!game.isGameMuted) stopMusic();\n  };\n\n  const getGameFromURL = () => {\n    console.log(\"speed\", searchParams.get(\"speed\"));\n    return new Game(Number(searchParams.get(\"speed\") || Game.INITIAL_SPEED), Number(searchParams.get(\"duration\") || Game.DURATION), Number(searchParams.get(\"charachterAdditionChance\") || CharacterManager.CHARACTER_ADDITION_CHANCE));\n  };\n\n  return /*#__PURE__*/React.createElement(AppContext.Provider, {\n    value: {\n      game,\n      start,\n      cancel,\n      cancelMusic,\n      chooseRule,\n      declineRule,\n      changeGameSounds,\n      stopMusic\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 5\n    }\n  }, children);\n}","map":{"version":3,"sources":["D:/programming stuff/strauss/client/src/helpers/AppContext.jsx"],"names":["React","useState","createContext","useContext","useForceUpdate","Game","CharacterManager","Rule","playSound","useMusic","AppContext","any","useGame","GameProvider","children","forceUpdate","game","setGame","intervalHandler","setIntervalHandler","undefined","searchParams","URLSearchParams","window","location","search","stopMusic","startMusic","start","getGameFromURL","localStorage","getItem","interval","setInterval","numberOfFinished","characterManager","charactersDone","length","step","isGameMuted","status","clearInterval","STEP","chooseRule","rule","declineRule","ruleManager","changeGameSounds","setItem","String","cancel","cancelMusic","console","log","get","Number","INITIAL_SPEED","DURATION","CHARACTER_ADDITION_CHANCE"],"mappings":"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","sourcesContent":["import React, { useState, createContext, useContext } from \"react\";\r\nimport { useForceUpdate } from \"./ForceUpdate\";\r\nimport Game from \"../logic/Game\";\r\nimport CharacterManager from \"../logic/CharacterManager\";\r\nimport { Rule } from \"../logic/Rule\";\r\nimport { playSound } from \"./Sounds\";\r\nimport { useMusic } from \"./MusicContext\";\r\n\r\nconst AppContext = createContext < any > null;\r\n\r\nexport const useGame = () => useContext(AppContext);\r\n\r\nexport function GameProvider({ children }) {\r\n  const forceUpdate = useForceUpdate();\r\n  const [game, setGame] = useState < any > new Game();\r\n  const [intervalHandler, setIntervalHandler] = useState < any > undefined;\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n  const { stopMusic, startMusic } = useMusic();\r\n\r\n  const start = () => {\r\n    const game = getGameFromURL();\r\n    setGame(game);\r\n    game.start();\r\n    if (\r\n      !localStorage.getItem(\"isGameMuted\") ||\r\n      localStorage.getItem(\"isGameMuted\") === \"false\"\r\n    )\r\n      startMusic();\r\n    const interval = setInterval(() => {\r\n      const numberOfFinished = game.characterManager.charactersDone().length;\r\n      game.step();\r\n      forceUpdate();\r\n      if (numberOfFinished < game.characterManager.charactersDone().length) {\r\n        playSound(\"meow\", game.isGameMuted);\r\n      }\r\n      if (game.status === \"over\") {\r\n        clearInterval(interval);\r\n        playSound(\"newHighScore\", game.isGameMuted);\r\n      }\r\n    }, Game.STEP * 1000);\r\n    setIntervalHandler(interval);\r\n  };\r\n\r\n  const chooseRule = (rule: Rule) => {\r\n    game.chooseRule(rule);\r\n    forceUpdate();\r\n  };\r\n\r\n  const declineRule = (rule: Rule) => {\r\n    game.ruleManager.declineRule(rule);\r\n    forceUpdate();\r\n  };\r\n\r\n  const changeGameSounds = () => {\r\n    localStorage.setItem(\"isGameMuted\", String(!game.isGameMuted));\r\n    if (!game.isGameMuted) stopMusic();\r\n    else startMusic();\r\n    game.isGameMuted = !game.isGameMuted;\r\n  };\r\n\r\n  const cancel = () => {\r\n    clearInterval(intervalHandler);\r\n    setIntervalHandler(undefined);\r\n    setGame(undefined);\r\n    forceUpdate();\r\n    if (!game.isGameMuted) stopMusic();\r\n  };\r\n\r\n  const cancelMusic = () => {\r\n    if (!game.isGameMuted) stopMusic();\r\n  };\r\n\r\n  const getGameFromURL = () => {\r\n    console.log(\"speed\", searchParams.get(\"speed\"));\r\n    return new Game(\r\n      Number(searchParams.get(\"speed\") || Game.INITIAL_SPEED),\r\n      Number(searchParams.get(\"duration\") || Game.DURATION),\r\n      Number(\r\n        searchParams.get(\"charachterAdditionChance\") ||\r\n          CharacterManager.CHARACTER_ADDITION_CHANCE\r\n      )\r\n    );\r\n  };\r\n\r\n  return (\r\n    <AppContext.Provider\r\n      value={{\r\n        game,\r\n        start,\r\n        cancel,\r\n        cancelMusic,\r\n        chooseRule,\r\n        declineRule,\r\n        changeGameSounds,\r\n        stopMusic,\r\n      }}\r\n    >\r\n      {children}\r\n    </AppContext.Provider>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}